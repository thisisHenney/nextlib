# foamdict/utils.py (또는 FoamData 내부)
from nextlib.openfoam.PyFoamDict4.foam_ast import Primitive, ListValue, DictValue


def unwrap(value):
    """
    AST → Python native type
    """
    if value is None:
        return None

    if isinstance(value, Primitive):
        return value.value

    if isinstance(value, ListValue):
        return [unwrap(v) for v in value.items]

    if isinstance(value, DictValue):
        return {
            k: unwrap(v[0]) if len(v) == 1 else [unwrap(x) for x in v]
            for k, v in value.entries.items()
        }

    return value
